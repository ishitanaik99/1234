function doGet(e)
{
  
  var ss = SpreadsheetApp.getActive();
  var sheet = ss.getSheetByName(e.parameter["id"]);
  if(e.parameter["id"] == "Inventory")
  {
   var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
   var lastRow = sheet.getLastRow();
   var cell = sheet.getRange('a1');
   var col = 0;
   var d = new Date();
   for (i in headers)
   {
    if (headers[i] == "Timestamp")
     {
      val = d.toDateString() + ", " + d.toLocaleTimeString();
     }
    else
     { 
      if(headers[i] =="Team Id")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Unique Id")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="SKU")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Item")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Priority")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Storage Number")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Cost")
       {
        val = e.parameter[headers[i]];
       }
      if(headers[i] =="Quantity")
       {
        val = e.parameter[headers[i]];
       }
    }
    cell.offset(lastRow, col).setValue(val);
    col++;
    
   }
  }
  
  
    if(e.parameter["id"] == "IncomingOrders")
     {
      var sheet = ss.getSheetByName(e.parameter["id"]);
      var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
      var lastRow = sheet.getLastRow();
      var cell = sheet.getRange('a1');
      var col = 0;
      var d = new Date();
      for (i in headers)
      {
       if (headers[i] == "Timestamp")
        {
          val = d.toDateString() + ", " + d.toLocaleTimeString();
        }
       else
         { 
          if(headers[i] =="Team Id")
           {
            val = e.parameter[headers[i]];
           }
          if(headers[i] =="Unique Id")
           { 
            val = e.parameter[headers[i]];
           }
         if(headers[i] =="Order ID")
           {
            val = e.parameter[headers[i]];
           }
         if(headers[i] =="Order Date and Time")
           {
            val = e.parameter[headers[i]];
             
           }
         if(headers[i] =="Item")
           { 
            val = e.parameter[headers[i]];
           }
         if(headers[i] =="Priority")
           {
           val = e.parameter[headers[i]];
           } 
         if(headers[i] =="Order Quantity")
          {
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="City")
          { 
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="Longitude")
          { 
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="Latitude")
          { 
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="Cost")
          { 
          val = e.parameter[headers[i]];
          }
        }
       cell.offset(lastRow, col).setValue(val);
       col++;
     
      }
    }
   if(e.parameter["id"] == "OrdersDispatched")
   {
      var sheet = ss.getSheetByName(e.parameter["id"]);
      var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
      var lastRow = sheet.getLastRow();
      var cell = sheet.getRange('a1');
      var col = 0;
      var d = new Date();
      for (i in headers)
      {
       if (headers[i] == "Timestamp")
        {
          val = d.toDateString() + ", " + d.toLocaleTimeString();
          //dispatch_time = d.toDateString() + ", " + d.toLocaleTimeString();
        }
       else
         { 
          if(headers[i] =="Team Id")
           {
            val = e.parameter[headers[i]];
           }
          if(headers[i] =="Unique Id")
           { 
            val = e.parameter[headers[i]];
           }
         if(headers[i] =="Order ID")
           {
            val = e.parameter[headers[i]];
            data_id = e.parameter[headers[i]];
           }
         if(headers[i] =="City")
           {
            val = e.parameter[headers[i]];
            data_city = e.parameter[headers[i]];
           }
         if(headers[i] =="Item")
           { 
            val = e.parameter[headers[i]];
            data_item = e.parameter[headers[i]];
           }
         if(headers[i] =="Priority")
           {
           val = e.parameter[headers[i]];
           data_pr = e.parameter[headers[i]];
           } 
         if(headers[i] =="Dispatch Quantity")
          {
          val = e.parameter[headers[i]];
           data_qty = e.parameter[headers[i]];
          }
         if(headers[i] =="Cost")
          { 
          val = e.parameter[headers[i]];
          data_cost = e.parameter[headers[i]];
          }
         if(headers[i] =="Dispatch Status")
          { 
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="Dispatch Date and Time")
          { 
             val = e.parameter[headers[i]];
             data_Disp = e.parameter[headers[i]];
          }
        }
       cell.offset(lastRow, col).setValue(val);
       col++;
     
      }  
  
     var to = "eyrc.vb.0461@gmail.com"; 

     var sub = "eyrc.vb.0000@gmail.com"
     var m1 = "Hello!\nYour Order has been Dispatched, contact us if you have any questions.\nWe are here to help you.\n\nORDER SUMMARY: \n\n" ; 
     var m2 = "Order number : " + data_id + "\nItem: " + data_item + "\nQuantity : " + data_qty + "\nDispatch Date and Time : " + data_Disp + "\nCity : " + data_city + "\nCost : " + data_cost;
     var message = m1+m2;
     MailApp.sendEmail(to, " alert! ", message);
     MailApp.sendEmail(sub, " alert! ", message);

  
    
    }
  
     if(e.parameter["id"] == "OrdersShipped")
   {
      var sheet = ss.getSheetByName(e.parameter["id"]);
      var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
      var lastRow = sheet.getLastRow();
      var cell = sheet.getRange('a1');
      var col = 0;
      var d = new Date();
      for (i in headers)
      {
       if (headers[i] == "Timestamp")
        {
          val = d.toDateString() + ", " + d.toLocaleTimeString();
          //shipped_time = d.toDateString() + ", " + d.toLocaleTimeString();
        }
       else
         { 
          if(headers[i] =="Team Id")
           {
            val = e.parameter[headers[i]];
           }
          if(headers[i] =="Unique Id")
           { 
            val = e.parameter[headers[i]];
           }
         if(headers[i] =="Order ID")
           {
            val = e.parameter[headers[i]];
            data_id = e.parameter[headers[i]];
           }
         if(headers[i] =="City")
           {
            val = e.parameter[headers[i]];
            data_city = e.parameter[headers[i]];
           }
         if(headers[i] =="Item")
           { 
            val = e.parameter[headers[i]];
            data_item = e.parameter[headers[i]];
           }
         if(headers[i] =="Priority")
           {
           val = e.parameter[headers[i]];
           data_pr = e.parameter[headers[i]];
           } 
         if(headers[i] =="Shipped Quantity")
          {
          val = e.parameter[headers[i]];
           data_qty = e.parameter[headers[i]];
          }
         if(headers[i] =="Cost")
          { 
          val = e.parameter[headers[i]];
          data_cost = e.parameter[headers[i]];
          }
         if(headers[i] =="Shipped Status")
          { 
          val = e.parameter[headers[i]];
          }
         if(headers[i] =="Shipped Date and Time")
          {
          val = e.parameter[headers[i]];
          data_shipped = e.parameter[headers[i]];
          
          
          }
         if(headers[i] =="Estimated Time of Delivery")
          { 
          val = e.parameter[headers[i]];
          data_day = e.parameter[headers[i]];
          }
        }
       cell.offset(lastRow, col).setValue(val);
       col++;
     
      }  
  
     var to = "eyrc.vb.0461@gmail.com";   

     //var sub = "eyrc.vb.0000@gmail.com"
     var m1 = "Hello!\nYour Order has been Shipped.It will be drone delivered to you in "+ data_day + " day. \nContact us if you have any questions.We are here to help you.\n\nORDER SUMMARY: \n\n" ; 
     var m2 = "Order number : " + data_id + "\nItem: " + data_item + "\nQuantity : " + data_qty + "\nShipped Date and Time : " + data_shipped + "\nCity : " + data_city + "\nCost : " + data_cost + "\nEstimated Time of Delivery : " + data_day;
     var message = m1+m2;
     MailApp.sendEmail(to, " alert! ", message);
     //MailApp.sendEmail(sub, " alert! ", message);
    
    }
  return HtmlService.createHtmlOutputFromFile('dashboard');
  return ContentService.createTextOutput('success');
  
  
}


